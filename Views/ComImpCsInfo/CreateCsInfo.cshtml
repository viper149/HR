@model ComImpCsInfoViewModel
@{
    ViewData["Title"] = "Create CS Info";
    Layout = Layout;
}

<h2><i class="fa fa-plus-circle fa-lg text-success" aria-hidden="true"></i> CS Information</h2>

<hr />
<div class="container-fluid">
    <div class="stepwizard">
        <div class="stepwizard-row setup-panel d-flex justify-content-around">
            <div class="stepwizard-step">
                <a href="#step-1" type="button" class="btn btn-success btn-circle">1</a>
                <p><small>Step 1</small></p>
            </div>
            <div class="stepwizard-step">
                <a href="#step-2" type="button" class="btn btn-default btn-circle border-1" disabled="disabled">2</a>
                <p><small>Step 2</small></p>
            </div>
            <div class="stepwizard-step">
                <a href="#step-3" type="button" class="btn btn-default btn-circle" disabled="disabled">3</a>
                <p><small>Finish</small></p>
            </div>
        </div>
    </div>

    <form id="form" role="form" asp-action="CreateCsInfo">
        <div class="panel panel-default setup-content" id="step-1">
            <div class="panel-body row">
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.CSNO" class="control-label"></label>
                        <input asp-for="ComImpCsInfo.CSNO" class="form-control" />
                        <span asp-validation-for="ComImpCsInfo.CSNO" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.CSDATE" class="control-label"></label>
                        <input asp-for="ComImpCsInfo.CSDATE" class="form-control" />
                        <span asp-validation-for="ComImpCsInfo.CSDATE" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.INDID" class="control-label"></label>
                        @Html.DropDownListFor(dt => dt.ComImpCsInfo.INDID, new SelectList(Model.YsIndentMasters, "INDID", "INDNO"), "Select Indent No", htmlAttributes: new { @class = "form-control js-example-basic-single" })
                        <span asp-validation-for="ComImpCsInfo.INDID" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.SUBJECT" class="control-label"></label>
                        <input asp-for="ComImpCsInfo.SUBJECT" class="form-control" />
                        <span asp-validation-for="ComImpCsInfo.SUBJECT" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.REVISEDNO" class="control-label"></label>
                        <input asp-for="ComImpCsInfo.REVISEDNO" class="form-control" />
                        <span asp-validation-for="ComImpCsInfo.REVISEDNO" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.NEXT_REVIEW_DATE" class="control-label"></label>
                        <input asp-for="ComImpCsInfo.NEXT_REVIEW_DATE" class="form-control" />
                        <span asp-validation-for="ComImpCsInfo.NEXT_REVIEW_DATE" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <button class="btn btn-info nextBtn pull-right" type="button">Next</button>
                    <a asp-action="GetCsInfo" class="btn btn-dark pull-right">Back to List</a>
                </div>
            </div>
        </div>

        <div class="panel panel-primary setup-content" id="step-2">
            <div class="panel-body row">
                <div class="pl-1 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <h2 class="panel-title text-success">Rate Information</h2>
                    <hr />
                </div>
                <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsItemDetails.ITEMID" class="control-label"></label>
                        @Html.DropDownListFor(dt => dt.ComImpCsItemDetails.ITEMID, new SelectList(Model.ProductInfos, "PRODID", "PRODNAME"), "Select Item", htmlAttributes: new { @class = "form-control js-example-basic-single" })
                        <span asp-validation-for="ComImpCsItemDetails.ITEMID" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsItemDetails.UNIT" class="control-label"></label>
                        <select class="form-control" asp-for="ComImpCsItemDetails.UNIT" readonly>
                            <option>Select Unit</option>
                            <option value="MTR">Meter</option>
                            <option value="YDS">Yard</option>
                            <option value="KG">KG</option>
                        </select>
                        <span asp-validation-for="ComImpCsItemDetails.UNIT" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsItemDetails.PREVIOUS_RATE" class="control-label"></label>
                        <input asp-for="ComImpCsItemDetails.PREVIOUS_RATE" class="form-control" />
                        <span asp-validation-for="ComImpCsItemDetails.PREVIOUS_RATE" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsItemDetails.QTY" class="control-label"></label>
                        <input asp-for="ComImpCsItemDetails.QTY" class="form-control" readonly/>
                        <span asp-validation-for="ComImpCsItemDetails.QTY" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <hr />
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsRatDetails.SUPPID" class="control-label"></label>
                        @Html.DropDownListFor(dt => dt.ComImpCsRatDetails.SUPPID, new SelectList(Model.SupplierInfos, "SUPPID", "SUPPNAME"), "Select Supplier", htmlAttributes: new { @class = "form-control js-example-basic-single" })
                        <span asp-validation-for="ComImpCsRatDetails.SUPPID" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsRatDetails.RATE" class="control-label"></label>
                        <input asp-for="ComImpCsRatDetails.RATE" class="form-control" />
                        <span asp-validation-for="ComImpCsRatDetails.RATE" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsRatDetails.ORIGIN" class="control-label"></label>
                        <input asp-for="ComImpCsRatDetails.ORIGIN" class="form-control" />
                        <span asp-validation-for="ComImpCsRatDetails.ORIGIN" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsRatDetails.TOTAL" class="control-label"></label>
                        <input asp-for="ComImpCsRatDetails.TOTAL" class="form-control" readonly />
                        <span asp-validation-for="ComImpCsRatDetails.TOTAL" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <button id="btnAdd" class="btn btn-success pull-right mr-2" type="button">Add</button>
                    <button class="btn btn-info nextBtn pull-right" type="button">Next</button>
                    <button class="btn btn-info prevBtn pull-right" type="button">Prev</button>
                    <a asp-action="GetCsInfo" class="btn btn-dark pull-right">Back to List</a>
                </div>

                <table class="table mt-2 table-condensed" style="border-collapse:collapse;" id="partialView">
                    <thead id="thead">
                        <tr>
                            <th></th>
                            <th>
                                @Html.DisplayNameFor(model => model.ComImpCsItemDetailsList.FirstOrDefault().ITEMID)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.ComImpCsItemDetailsList.FirstOrDefault().UNIT)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.ComImpCsItemDetailsList.FirstOrDefault().PREVIOUS_RATE)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.ComImpCsItemDetailsList.FirstOrDefault().QTY)
                            </th>
                            <th>
                                @Html.DisplayName("Remove")
                            </th>
                        </tr>
                    </thead>
                    <tbody id="csDetails"></tbody>
                </table>

            </div>
        </div>
        <div class="panel panel-primary setup-content" id="step-3">
            <div class="panel-body row">

                <div class="pl-1 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <h2 class="panel-title text-success">Justification Against Purchase</h2>
                    <hr />
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.LOWESTPRICE" class="control-label"></label>
                        <div class="form-control custom-form-control">
                            <label class="switch">
                                <input asp-for="ComImpCsInfo.LOWESTPRICE" />
                                <span class="slider round"></span>
                                <span class="absolute-no">NO</span>
                            </label>
                        </div>
                        <span asp-validation-for="ComImpCsInfo.LOWESTPRICE" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.QUALITY" class="control-label"></label>
                        <div class="form-control custom-form-control">
                            <label class="switch">
                                <input asp-for="ComImpCsInfo.QUALITY" />
                                <span class="slider round"></span>
                                <span class="absolute-no">NO</span>
                            </label>
                        </div>
                        <span asp-validation-for="ComImpCsInfo.QUALITY" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.URECOM" class="control-label"></label>
                        <div class="form-control custom-form-control">
                            <label class="switch">
                                <input asp-for="ComImpCsInfo.URECOM" />
                                <span class="slider round"></span>
                                <span class="absolute-no">NO</span>
                            </label>
                        </div>
                        <span asp-validation-for="ComImpCsInfo.URECOM" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.CRFACILITIES" class="control-label"></label>
                        <div class="form-control custom-form-control">
                            <label class="switch">
                                <input asp-for="ComImpCsInfo.CRFACILITIES" />
                                <span class="slider round"></span>
                                <span class="absolute-no">NO</span>
                            </label>
                        </div>
                        <span asp-validation-for="ComImpCsInfo.CRFACILITIES" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.AVAILABLE" class="control-label"></label>
                        <div class="form-control custom-form-control">
                            <label class="switch">
                                <input asp-for="ComImpCsInfo.AVAILABLE" />
                                <span class="slider round"></span>
                                <span class="absolute-no">NO</span>
                            </label>
                        </div>
                        <span asp-validation-for="ComImpCsInfo.AVAILABLE" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.USEDBY_OTHERUNIT" class="control-label"></label>
                        <div class="form-control custom-form-control">
                            <label class="switch">
                                <input asp-for="ComImpCsInfo.USEDBY_OTHERUNIT" />
                                <span class="slider round"></span>
                                <span class="absolute-no">NO</span>
                            </label>
                        </div>
                        <span asp-validation-for="ComImpCsInfo.USEDBY_OTHERUNIT" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.SOLE_AGENT" class="control-label"></label>
                        <div class="form-control custom-form-control">
                            <label class="switch">
                                <input asp-for="ComImpCsInfo.SOLE_AGENT" />
                                <span class="slider round"></span>
                                <span class="absolute-no">NO</span>
                            </label>
                        </div>
                        <span asp-validation-for="ComImpCsInfo.SOLE_AGENT" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.LISTED" class="control-label"></label>
                        <div class="form-control custom-form-control">
                            <label class="switch">
                                <input asp-for="ComImpCsInfo.LISTED" />
                                <span class="slider round"></span>
                                <span class="absolute-no">NO</span>
                            </label>
                        </div>
                        <span asp-validation-for="ComImpCsInfo.LISTED" class="text-danger"></span>
                    </div>
                </div>

                <div class="pl-1 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <h2 class="panel-title text-success">Price Verification Process</h2>
                    <hr />
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.OVER_PHONE" class="control-label"></label>
                        <div class="form-control custom-form-control">
                            <label class="switch">
                                <input asp-for="ComImpCsInfo.OVER_PHONE" />
                                <span class="slider round"></span>
                                <span class="absolute-no">NO</span>
                            </label>
                        </div>
                        <span asp-validation-for="ComImpCsInfo.OVER_PHONE" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.OVER_EMAIL" class="control-label"></label>
                        <div class="form-control custom-form-control">
                            <label class="switch">
                                <input asp-for="ComImpCsInfo.OVER_EMAIL" />
                                <span class="slider round"></span>
                                <span class="absolute-no">NO</span>
                            </label>
                        </div>
                        <span asp-validation-for="ComImpCsInfo.OVER_EMAIL" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.PHYSICALLY" class="control-label"></label>
                        <div class="form-control custom-form-control">
                            <label class="switch">
                                <input asp-for="ComImpCsInfo.PHYSICALLY" />
                                <span class="slider round"></span>
                                <span class="absolute-no">NO</span>
                            </label>
                        </div>
                        <span asp-validation-for="ComImpCsInfo.PHYSICALLY" class="text-danger"></span>
                    </div>
                </div>

                <div class="pl-1 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <h2 class="panel-title text-success">Common Terms & Conditions</h2>
                    <hr />
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.PAYMODE" class="control-label"></label>
                        <input asp-for="ComImpCsInfo.PAYMODE" class="form-control" />
                        <span asp-validation-for="ComImpCsInfo.PAYMODE" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.AITSTATUS" class="control-label"></label>
                        <input asp-for="ComImpCsInfo.AITSTATUS" class="form-control" />
                        <span asp-validation-for="ComImpCsInfo.AITSTATUS" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.VAT" class="control-label"></label>
                        <input asp-for="ComImpCsInfo.VAT" class="form-control" />
                        <span asp-validation-for="ComImpCsInfo.VAT" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="ComImpCsInfo.WARRANTEE" class="control-label"></label>
                        <input asp-for="ComImpCsInfo.WARRANTEE" class="form-control" />
                        <span asp-validation-for="ComImpCsInfo.WARRANTEE" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <button class="btn btn-success pull-right" type="submit">Create</button>
                    <button class="btn btn-info prevBtn pull-right" type="button">Prev</button>
                    <a asp-action="GetCsInfo" class="btn btn-dark pull-right mr-2">Back to List</a>
                </div>
            </div>
        </div>
    </form>
</div>

@section Styles {
    <link href="~/css/CustomCSS/Stepper.css" rel="stylesheet" asp-append-version="true" />
}

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptPartial_Except_jQuery");}
    <script src="~/js/custom-js/Stepper.js" asp-append-version="true"></script>
    <script type="text/javascript" asp-append-version="true">
        $(function() {
            $("#ComImpCsItemDetails_QTY").on("change",
                function() {
                    $('#ComImpCsRatDetails_TOTAL').val($('#ComImpCsItemDetails_QTY').val() * $('#ComImpCsRatDetails_RATE').val());
                });

            $("#ComImpCsRatDetails_RATE").on("change",
                function() {
                    $('#ComImpCsRatDetails_TOTAL').val($('#ComImpCsItemDetails_QTY').val() * $('#ComImpCsRatDetails_RATE').val());
                });

            $("#ComImpCsInfo_INDID").on("change",
                function() {
                    var selectedItem = $(this).val();
                    $.ajax({
                        async: true,
                        cache: false,
                        data: {"indId" : selectedItem},
                        type: "GET",
                        url: '/ComImpCsInfo/GetIndentYarnList',
                        success: function (data) {
                            var item = $("#ComImpCsItemDetails_ITEMID");
                            item.html('');
                            item.append('<option value="" selected>Select Item</option>');

                            $.each(data, function (id, option) {
                                item.append($('<option></option>').val(option.countid).html(option.countname));
                            });
                        },
                        error: function(e) {
                            console.log(e);
                        }
                    });
                });

            $("#ComImpCsItemDetails_ITEMID").on("change",
                function() {
                    var selectedItem = $(this).val();
                    $.ajax({
                        async: true,
                        cache: false,
                        data: {"prodId" : selectedItem, "indId" : $("#ComImpCsInfo_INDID").val()},
                        type: "GET",
                        url: '/ComImpCsInfo/GetIndentQty',
                        success: function (data) {
                            console.log(data);
                            $("#ComImpCsItemDetails_QTY").val(data.ordeR_QTY);
                            $("#ComImpCsItemDetails_UNIT").val(data.unit);
                        },
                        error: function(e) {
                            console.log(e);
                        }
                    });
                });

            $("#btnAdd").on('click',
                function() {
                    $.ajax({
                        async: true,
                        cache: false,
                        data: $('#form').serialize(),
                        type: "POST",
                        url: '/ComImpCsInfo/AddCsDetails',
                        success: function(partialView) {
                            console.log(partialView);
                            $('#csDetails').html(partialView);
                        },
                        error: function(e) {
                            console.log(e);
                        }
                    });
                });
        });
    </script>
}