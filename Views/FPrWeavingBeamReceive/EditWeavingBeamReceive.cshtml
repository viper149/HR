@model PrWeavingProcessViewModel
@{
    ViewData["Title"] = "Weaving Beam Receive";
    Layout = Layout;
}

<h2><i class="fa fa-edit fa-lg text-warning" aria-hidden="true"></i> Weaving Beam Receive</h2>
<hr />

<div class="container-fluid">
    <div class="stepwizard">
        <div class="stepwizard-row setup-panel d-flex justify-content-around">
            <div class="stepwizard-step">
                <a href="#step-1" type="button" class="btn btn-success btn-circle">1</a>
                <p><small>Step 1</small></p>
            </div>
            <div class="stepwizard-step">
                <a href="#step-2" type="button" class="btn btn-default btn-circle" disabled="disabled">2</a>
                <p><small>Finish</small></p>
            </div>
        </div>
    </div>
    <form id="form" role="form" asp-action="EditWeavingBeamReceive">
        <div class="panel panel-default setup-content" id="step-1">
            <div class="panel-body row">
                @Html.HiddenFor(c => c.FPrWeavingBeamReceiving.RCVID)
                @Html.HiddenFor(c => c.FPrWeavingBeamReceiving.EncryptedId)
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingBeamReceiving.RCVDATE" class="control-label"></label>
                        <input asp-for="FPrWeavingBeamReceiving.RCVDATE" class="form-control" />
                        <span asp-validation-for="FPrWeavingBeamReceiving.RCVDATE" class="text-danger"></span>
                    </div>
                </div>
                @*<div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
            <div class="form-group">
                <label asp-for="FPrWeavingBeamReceiving.SETID" class="control-label"></label>
                @Html.DropDownListFor(dt => dt.FPrWeavingBeamReceiving.SETID, new SelectList(Model.PlProductionSetDistributions, "SETID", "PROG_.PROG_NO"), "Select Program/Set No.", htmlAttributes: new { @class = "form-control js-example-basic-single", @readonly = "true" })
                <span asp-validation-for="FPrWeavingBeamReceiving.SETID" class="text-danger"></span>
            </div>
        </div>*@

                @Html.HiddenFor(c => c.FPrWeavingBeamReceiving.SETID)

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingBeamReceiving.SETID" class="control-label"></label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="set">
                        </span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingBeamReceiving.RCVDBY" class="control-label"></label>
                        @Html.DropDownListFor(dt => dt.FPrWeavingBeamReceiving.RCVDBY, new SelectList(Model.FHrEmployees, "EMPID", "FIRST_NAME"), "Select Employee", htmlAttributes: new { @class = "form-control js-example-basic-single" })
                        <span asp-validation-for="FPrWeavingBeamReceiving.RCVDBY" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingBeamReceiving.LOOMSPEED" class="control-label"></label>
                        <input asp-for="FPrWeavingBeamReceiving.LOOMSPEED" class="form-control" />
                        <span asp-validation-for="FPrWeavingBeamReceiving.LOOMSPEED" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingBeamReceiving.EFFICIENCY" class="control-label"></label>
                        <input asp-for="FPrWeavingBeamReceiving.EFFICIENCY" class="form-control" />
                        <span asp-validation-for="FPrWeavingBeamReceiving.EFFICIENCY" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Style Name</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="style">
                        </span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Buyer</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="buyer">
                        </span>
                    </div>
                </div>

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Set Length</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="setLength">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Total Ends</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="totalEnds">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Color</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="color">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Loom Type</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="loomType">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Order No</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="orderNo">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">PO No</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="poNo">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingBeamReceiving.REMARKS" class="control-label"></label>
                        <input asp-for="FPrWeavingBeamReceiving.REMARKS" class="form-control" />
                        <span asp-validation-for="FPrWeavingBeamReceiving.REMARKS" class="text-danger"></span>
                    </div>
                </div>

                <div class="pl-1 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div>
                        <h2 class="panel-title text-success">Weft Yarn Consumption</h2>
                    </div>
                    <hr />
                </div>
                @Html.HiddenFor(c => c.FPrWeavingWeftYarnConsumDetails.COUNTID)
                @Html.HiddenFor(c => c.FPrWeavingWeftYarnConsumDetails.LOTID)
                @Html.HiddenFor(c => c.FPrWeavingWeftYarnConsumDetails.SUPPID)
                @Html.HiddenFor(c => c.FPrWeavingWeftYarnConsumDetails.RATIO)
                @Html.HiddenFor(c => c.FPrWeavingWeftYarnConsumDetails.SET_BGT)
                @Html.HiddenFor(c => c.FPrWeavingWeftYarnConsumDetails.ACT_BGT)

                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Yarn Count</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="count">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Lot No.</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="lot">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Supplier Name</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="supplier">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Ratio</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="ratioYarn">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Set Budget</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="budget">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label class="control-label">Actual Budget</label>
                        <span class="custom-form-control-bg form-control bg-e9ecef" id="actBudget">
                        </span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingWeftYarnConsumDetails.YARN_RECEIVE" class="control-label"></label>
                        <input asp-for="FPrWeavingWeftYarnConsumDetails.YARN_RECEIVE" class="form-control" />
                        <span asp-validation-for="FPrWeavingWeftYarnConsumDetails.YARN_RECEIVE" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingWeftYarnConsumDetails.YARN_RETURN" class="control-label"></label>
                        <input asp-for="FPrWeavingWeftYarnConsumDetails.YARN_RETURN" class="form-control" />
                        <span asp-validation-for="FPrWeavingWeftYarnConsumDetails.YARN_RETURN" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingWeftYarnConsumDetails.WASTE" class="control-label"></label>
                        <input asp-for="FPrWeavingWeftYarnConsumDetails.WASTE" class="form-control" />
                        <span asp-validation-for="FPrWeavingWeftYarnConsumDetails.WASTE" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingWeftYarnConsumDetails.WASTE_PERCENTAGE" class="control-label"></label>
                        <input asp-for="FPrWeavingWeftYarnConsumDetails.WASTE_PERCENTAGE" class="form-control" readonly="readonly" />
                        <span asp-validation-for="FPrWeavingWeftYarnConsumDetails.WASTE_PERCENTAGE" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingWeftYarnConsumDetails.CONSUMP" class="control-label"></label>
                        <input asp-for="FPrWeavingWeftYarnConsumDetails.CONSUMP" class="form-control" readonly="readonly" />
                        <span asp-validation-for="FPrWeavingWeftYarnConsumDetails.CONSUMP" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6 col-xs-12">
                    <div class="form-group">
                        <label asp-for="FPrWeavingWeftYarnConsumDetails.REMARKS" class="control-label"></label>
                        <input asp-for="FPrWeavingWeftYarnConsumDetails.REMARKS" class="form-control" />
                        <span asp-validation-for="FPrWeavingWeftYarnConsumDetails.REMARKS" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <button class="btn btn-info nextBtn pull-right" type="button">Next</button>
                    <button id="btnAddYarn" class="btn btn-success pull-right mr-2" type="button">Add Consumption</button>
                    <a asp-action="GetWeavingBeamReceiveList" class="btn btn-dark pull-right">Back to List</a>
                </div>

                <div class="table-responsive">
                    <table class="table mt-2 table-condensed" style="border-collapse: collapse;" id="partialView">
                        <thead id="thead">
                            <tr>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.COUNTID)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.LOTID)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.SUPPID)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.RATIO)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.SET_BGT)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.ACT_BGT)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.CONSUMP)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.YARN_RECEIVE)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.YARN_RETURN)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.WASTE)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.WASTE_PERCENTAGE)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.FPrWeavingWeftYarnConsumDetails.REMARKS)
                                </th>
                                <th>
                                    @Html.DisplayName("Actions")
                                </th>
                            </tr>
                        </thead>
                        <tbody id="yarnDetails"></tbody>
                    </table>
                    </div>
                </div>
            </div>

        <div class="panel panel-primary setup-content" id="step-2">
            <div class="panel-body row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <h2 class="panel-title text-success">Received Beam Information</h2>
                    <hr />
                </div>
                <div class="table-responsive">
                    <table class="table mt-2">
                        <thead id="thead">
                        <tr>
                            <th>
                                Machine No.
                            </th>
                            <th>
                                Beam No.
                            </th>
                            <th>
                                @Html.DisplayName("Beam Type")
                            </th>
                            <th>
                                @Html.DisplayName("Length")
                            </th>
                            <th>
                                @Html.DisplayName("Break.")
                            </th>
                            <th>
                                @Html.DisplayName("Ends")
                            </th>
                            <th>
                                @Html.DisplayName("Shift")
                            </th>
                            <th>
                                @Html.DisplayName("Remarks")
                            </th>
                            <th>
                                @Html.DisplayName("Is Received?")
                            </th>
                        </tr>
                        </thead>
                        <tbody id="beamDetails"></tbody>
                    </table>
                    </div>
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <button class="btn btn-warning pull-right" type="submit" id="btn_submit">Update</button>
                        <button class="btn btn-info prevBtn pull-right" type="button">Prev</button>
                        <a asp-action="GetWeavingBeamReceiveList" class="btn btn-dark pull-right mr-2">Back to List</a>
                    </div>
                </div>
            </div>
    </form>
</div>

@section Styles {
    <link href="~/css/CustomCSS/Stepper.css" rel="stylesheet" asp-append-version="true" />

}

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptPartial_Except_jQuery");}
    <script src="~/js/custom-js/Stepper.js" asp-append-version="true"></script>
    <script type="text/javascript" asp-append-version="true">
        
        $(function () {
            
            getSetInfo($("#FPrWeavingBeamReceiving_SETID").val());

            $("#btnAddYarn").on('click',
                function () {
                    swal({
                            title: "Please Confirm",
                            text: "Data Will Directly Updated to Database",
                            type: "info",
                            showCancelButton: true,
                            confirmButtonText: "OK",
                            cancelButtonText: "Cancel"
                        },
                        function (isConfirm) {
                            if (isConfirm) {
                                $.ajax({
                                    async: true,
                                    cache: false,
                                    data: $('#form').serialize(),
                                    type: "POST",
                                    url: "/FPrWeavingBeamReceive/AddYarnToDb",
                                    success: function(data, status, xhr) {
                                        if (data) {
                                            toastr.success("Success!!", "Success");
                                        } else {
                                            toastr.error("Error, Please Try Again!", "Error");
                                        }
                                        getSetInfo($("#FPrWeavingBeamReceiving_SETID").val());
                                    },
                                    error: function(e) {
                                        console.log(e);
                                    }
                                });
                            }
                        });
                    });

            $("#FPrWeavingBeamReceiving_SETID").on('change',
                function() {
                    var selectedVal = $(this).val();
                    getSetInfo(selectedVal);
                });
        });
        
        function editYarnConsumption(e) {
            var count_name = $(e.target).closest('tr').find(".count_name").html();
            var lot_name = $(e.target).closest('tr').find(".lot_name").html();
            var supp_name = $(e.target).closest('tr').find(".supp_name").html();

            var countid = $(e.target).closest('tr').find(".countid").html();
            var lotid = $(e.target).closest('tr').find(".lotid").html();
            var suppid = $(e.target).closest('tr').find(".suppid").html();

            var ratio = $(e.target).closest('tr').find(".ratio").html();
            var setQty = $(e.target).closest('tr').find(".setQty").html();
            var actQty = $(e.target).closest('tr').find(".actQty").html();

            $("#count").text(count_name);
            $("#lot").text(lot_name);
            $("#supplier").text(supp_name);
            $("#ratioYarn").text(ratio);
            $("#budget").text(setQty);
            $("#actBudget").text(actQty);


            $("#FPrWeavingWeftYarnConsumDetails_COUNTID").val(countid);
            $("#FPrWeavingWeftYarnConsumDetails_LOTID").val(lotid);
            $("#FPrWeavingWeftYarnConsumDetails_SUPPID").val(suppid);
            $("#FPrWeavingWeftYarnConsumDetails_RATIO").val(ratio);
            $("#FPrWeavingWeftYarnConsumDetails_SET_BGT").val(setQty);
            $("#FPrWeavingWeftYarnConsumDetails_ACT_BGT").val(actQty);
            // Let's test it out
            // console.log(count_name, lot_name, supp_name, ratio, setQty, actQty);
        }

        function doApprove(sdid) {
            if (sdid !== undefined) {
                $.ajax({
                    async: true,
                    cache: false,
                    data: {
                        "sdid": sdid
                    },
                    type: "GET",
                    url: "/FPrWeavingBeamReceive/DoApprove",
                    success: function(data) {
                        if (data) {
                            toastr.success("Received", "Success");
                        } else {
                            toastr.error("You Can Not Receive", "Invalid Submission");
                        }
                    },
                    error: function() {
                        toastr.error("No Access.", "Invalid Submission");
                    }
                });
            }
        }

        function DoApproveSlasherBeam(sdid) {
            if (sdid !== undefined) {
                $.ajax({
                    async: true,
                    cache: false,
                    data: {
                        "sdid": sdid
                    },
                    type: "GET",
                    url: "/FPrWeavingBeamReceive/DoApproveSlasherBeam",
                    success: function (data) {
                        if (data) {
                            toastr.success("Received", "Success");
                        } else {
                            toastr.error("You Can Not Receive", "Invalid Submission");
                        }
                    },
                    error: function () {
                        toastr.error("No Access.", "Invalid Submission");
                    }
                });
            }
        }
        
        var consum = $("#FPrWeavingWeftYarnConsumDetails_CONSUMP");
        var yrnRcv = $("#FPrWeavingWeftYarnConsumDetails_YARN_RECEIVE");
        var yrnRet = $("#FPrWeavingWeftYarnConsumDetails_YARN_RETURN");
        var waste = $("#FPrWeavingWeftYarnConsumDetails_WASTE");
            
        yrnRcv.on("change", function () {
            getWastePercentage();
            getConsump();
        });

        yrnRet.on("change", function () {
            getConsump();
        });

        waste.on("change", function () {
            getWastePercentage();
            getConsump();
        });
        
        function getWastePercentage() {
            var wastePercentage = $("#FPrWeavingWeftYarnConsumDetails_WASTE_PERCENTAGE");
            var result = (waste.val() * 100) / yrnRcv.val();
            wastePercentage.val(result.toFixed(3));
        }
        function getConsump() {

            var yrnRecv = parseFloat(yrnRcv.val());
            var yrnRetu = parseFloat(yrnRet.val());
            var yrnWaste = parseFloat(waste.val());

            var result = yrnRecv - (yrnRetu + yrnWaste);
            consum.val(result.toFixed(0));
        }

        function getSetInfo(selectedVal) {
            
                    $.ajax({
                        async: true,
                        cache: false,
                        data: { "setId": selectedVal },
                        type: "GET",
                        url: "/FLcbProductionRope/GetSetDetails",
                        success: function(data, status, xhr) {
                            console.log(data);
                            $("#set").text(data.plProductionSetDistribution.proG_.proG_NO);
                            $("#style").text(data.comExPiDetails.style.fabcodeNavigation.stylE_NAME);
                            $("#buyer").text(data.comExPiDetails.pimaster.buyer.buyeR_NAME);
                            $("#color").text(data.comExPiDetails.style.fabcodeNavigation.colorcodeNavigation.color);
                            $("#loomType").text(data.comExPiDetails.style.fabcodeNavigation.loom.looM_TYPE_NAME);
                            $("#orderNo").text(data.comExPiDetails.sO_NO);
                            $("#ratio").text(data.plProductionSetDistribution.subgroup.ratio);
                            $("#totalEnds").text(data.plProductionSetDistribution.proG_.blK_PROG_.rndProductionOrder.totaL_ENOS);
                            $("#setLength").text(data.plProductionSetDistribution.proG_.seT_QTY);
                            $("#poNo").text(data.comExPiDetails.pimaster.pino);
                            
                            var warpLength = '';
                            
                            if (data.plProductionSetDistribution.subgroup.group.rnD_DYEING_TYPE.dtype === 'Rope') {
                                warpLength = data.plProductionSetDistribution.f_PR_WARPING_PROCESS_ROPE_DETAILS[0].warP_LENGTH_PER_SET;
                            }
                            else if(data.plProductionSetDistribution.subgroup.group.rnD_DYEING_TYPE.dtype === 'Slasher') {
                                warpLength = data.plProductionSetDistribution.f_PR_SLASHER_DYEING_MASTER.warplength;
                            }

                            var greyLength = warpLength * 0.92;
                            var totalRatioWeft = 0;

                            var warpSetLength = data.plProductionSetDistribution.proG_.seT_QTY;
                            var greySetLength = warpLength * 0.92;


                            $.each(data.rndFabricCountInfoViewModels,
                                function(id, option) {
                                    if (option.rndFabricCountinfo.yarnfor === 2) {
                                        totalRatioWeft += parseFloat(option.rndFabricCountinfo.ratio);
                                    }
                                });
                            var yarnData = "";
                            var beamData = "";
                            $.each(data.rndFabricCountInfoViewModels,
                                function(id, option) {
                                    if (option.rndFabricCountinfo.yarnfor === 2) {

                                        var reqKgs = 0;
                                        reqKgs = (greyLength * data.comExPiDetails.style.fabcodeNavigation.reeD_SPACE * data.comExPiDetails.style.fabcodeNavigation.grppi * option.rndFabricCountinfo.ratio) / (option.rndFabricCountinfo.ne * totalRatioWeft * 768 * 2.2046);

                                        var reqSetKgs = 0;
                                        reqSetKgs = (greySetLength * data.comExPiDetails.style.fabcodeNavigation.reeD_SPACE * data.comExPiDetails.style.fabcodeNavigation.grppi * option.rndFabricCountinfo.ratio) / (option.rndFabricCountinfo.ne * totalRatioWeft * 768 * 2.2046);

                                        var actionButton = '';
                                        if (!option.isConsumption) {
                                            actionButton = "<a class='fa fa-edit fa-2x-custom text-warning editYarnConsumption' onclick=editYarnConsumption(event);></a>";
                                        } else {
                                            actionButton = "<div class=\"round_gol\"><input type=\"checkbox\" name=\"" + option.rndFabricCountinfo.count.countname + "\" id=\"" + option.rndFabricCountinfo.count.countname + "\" checked disabled/><label for=\"" + option.rndFabricCountinfo.count.countname + "\"></label></div>";
                                        }
                                        var consump = "";
                                        var yarnReceive = "";
                                        var yarnReturn = "";
                                        var waste = "";
                                        var wastE_PERCENTAGE = "";
                                        var remarks = "";
                                        if (option.fPrWeavingWeftYarnConsumDetails != null) {
                                            yarnReceive = option.fPrWeavingWeftYarnConsumDetails.yarN_RECEIVE;
                                            yarnReturn = option.fPrWeavingWeftYarnConsumDetails.yarN_RETURN;
                                            consump = option.fPrWeavingWeftYarnConsumDetails.consump;
                                            waste = option.fPrWeavingWeftYarnConsumDetails.waste;
                                            wastE_PERCENTAGE = option.fPrWeavingWeftYarnConsumDetails.wastE_PERCENTAGE;
                                            remarks = option.fPrWeavingWeftYarnConsumDetails.remarks;
                                        }


                                        var tr = "<tr>" +
                                            " <td class='count_name'> " + option.rndFabricCountinfo.count.countname + "</td > " +
                                            " <td class='countid d-none'> " + option.rndFabricCountinfo.trnsid + "</td > " +

                                            " <td class='lot_name'> " + option.rndFabricCountinfo.lot.lotno + "</td> " +
                                            " <td class='lotid d-none'> " + option.rndFabricCountinfo.lotid + "</td> " +

                                            " <td class='supp_name'> " + option.rndFabricCountinfo.supp.suppname + "</td> "+
                                            " <td class='suppid d-none'> " + option.rndFabricCountinfo.suppid + "</td> "

                                            + " <td class='ratio'> " + option.rndFabricCountinfo.ratio + " </td> "
                                            + " <td class='setQty'> " + reqSetKgs.toFixed(0) + " </td> "
                                            + " <td class='actQty'> " + reqKgs.toFixed(0) + " </td> "

                                            + " <td class='consump'> " + consump + " </td> "
                                            + " <td class='yarnReceive'> " + yarnReceive + " </td> "
                                            + " <td class='yarnReturn'> " + yarnReturn + " </td> "
                                            + " <td class='waste'> " + waste + " </td> "
                                            + " <td class='wastE_PERCENTAGE'> " + wastE_PERCENTAGE + " </td> "
                                            + " <td class='remarks'> " + remarks + " </td> "
                                            + " </td> " + " <td>" + actionButton + "</td> " +
                                            "</tr >";

                                        yarnData += tr;
                                    }
                                });

                            $("#yarnDetails").html(yarnData);

                            
                            if (data.plProductionSetDistribution.subgroup.group.rnD_DYEING_TYPE.dtype === 'Rope') {
                                $.each(data.plProductionSetDistribution.f_PR_SIZING_PROCESS_ROPE_MASTER[0].f_PR_SIZING_PROCESS_ROPE_DETAILS,
                                    function (id, option) {
                                        var isReceived = "";

                                        if (option.iS_WEAVING_RECEIVED) {
                                            isReceived = "  <div class=\"round_gol\"><input type=\"checkbox\" name=\"" + option.w_BEAM.beaM_NO + "_" + option.s_M.machinE_NO + "\" id=\"" + option.w_BEAM.beaM_NO + "_" + option.s_M.machinE_NO + "\" checked disabled/><label for=\"" + option.w_BEAM.beaM_NO + "_" + option.s_M.machinE_NO + "\"></label></div>";
                                        }
                                        else {
                                            isReceived = "<div class=\"round_gol\"><input onclick=\"doApprove('" + option.sdid + "')\" type=\"checkbox\" name=\"" + option.w_BEAM.beaM_NO + "_" + option.s_M.machinE_NO + "\" id=\"" + option.w_BEAM.beaM_NO + "_" + option.s_M.machinE_NO + "\"/><label for=\"" + option.w_BEAM.beaM_NO + "_" + option.s_M.machinE_NO + "\"></label></div>";
                                        }
                                        if (option.iS_DELIVERABLE) {
                                            var tr = "<tr>" +
                                                " <td> " + option.s_M.machinE_NO + " </td > " +
                                                " <td> " + option.w_BEAM.beaM_NO + " </td> " +
                                                " <td> " + option.beaM_TYPE + " </td> " +
                                                " <td> " + option.lengtH_PER_BEAM + " </td> " +
                                                " <td> " + option.breaK_PER_BEAM + " </td> " +
                                                " <td> " + data.plProductionSetDistribution.f_PR_SIZING_PROCESS_ROPE_MASTER[0].totaL_ENDS + " </td> " +
                                                " <td> " + option.shift + " </td> " +
                                                " <td> " + option.remarks + " </td> " +
                                                " <td> " + isReceived + " </td> " +
                                                "</tr >";
                                            beamData += tr;
                                        }
                                    });
                            }
                            else if(data.plProductionSetDistribution.subgroup.group.rnD_DYEING_TYPE.dtype === 'Slasher') {
                                $.each(data.plProductionSetDistribution.f_PR_SLASHER_DYEING_MASTER[0].f_PR_SLASHER_DYEING_DETAILS,
                                    function (id, option) {
                                        var isReceived = "";

                                        if (option.iS_WEAVING_RECEIVED) {
                                            isReceived = "  <div class=\"round_gol\"><input type=\"checkbox\" name=\"" + option.w_BEAM.beaM_NO + "_" + option.sL_M.sL_MNO + "\" id=\"" + option.w_BEAM.beaM_NO + "_" + option.sL_M.sL_MNO + "\" checked disabled/><label for=\"" + option.w_BEAM.beaM_NO + "_" + option.sL_M.sL_MNO + "\"></label></div>";
                                        }
                                        else {
                                            isReceived = "<div class=\"round_gol\"><input onclick=\"doApprove('" + option.sldid + "')\" type=\"checkbox\" name=\"" + option.w_BEAM.beaM_NO + "_" + option.sL_M.sL_MNO + "\" id=\"" + option.w_BEAM.beaM_NO + "_" + option.sL_M.sL_MNO + "\"/><label for=\"" + option.w_BEAM.beaM_NO + "_" + option.sL_M.sL_MNO + "\"></label></div>";
                                        }
                                        if (option.iS_DELIVERABLE) {
                                            var tr = "<tr>" +
                                                " <td> " + option.sL_M.sL_MNO + " </td > " +
                                                " <td> " + option.w_BEAM.beaM_NO + " </td> " +
                                                " <td> " + option.beaM_TYPE + " </td> " +
                                                " <td> " + option.lengtH_PER_BEAM + " </td> " +
                                                " <td> " + option.breaK_PER_BEAM + " </td> " +
                                                " <td> " + data.plProductionSetDistribution.f_PR_SLASHER_DYEING_MASTER[0].totaL_ENDS + " </td> " +
                                                " <td> " + option.shift + " </td> " +
                                                " <td> " + option.remarks + " </td> " +
                                                " <td> " + isReceived + " </td> " +
                                                "</tr >";
                                            beamData += tr;
                                        }
                                    });
                            }


                            $("#beamDetails").html(beamData);
                        },
                        error: function(e) {
                            console.log(e);
                        }
                    });
        }
    </script>
}